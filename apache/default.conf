<VirtualHost *:80>
    ServerName petrucodes.ro
    ServerAlias www.petrucodes.ro

    DocumentRoot /var/www/html/public

    <Directory /var/www/html/public>
        Options Indexes FollowSymLinks
        AllowOverride All
        Require all granted
    </Directory>

    # Let's Encrypt challenge
    Alias /.well-known/acme-challenge/ /var/www/certbot/
    <Directory "/var/www/certbot/">
        AllowOverride None
        Options None
        Require all granted
    </Directory>

    # Redirect all HTTP to HTTPS
    RewriteEngine on
    RewriteCond %{SERVER_NAME} =petrucodes.ro [OR]
    RewriteCond %{SERVER_NAME} =www.petrucodes.ro
    RewriteRule ^ https://%{SERVER_NAME}%{REQUEST_URI} [END,NE,R=permanent]
</VirtualHost>

<VirtualHost *:443>
    ServerName petrucodes.ro
    ServerAlias www.petrucodes.ro

    DocumentRoot /var/www/html/public

    <Directory /var/www/html/public>
        Options Indexes FollowSymLinks
        AllowOverride All
        Require all granted
    </Directory>

    SSLEngine on
    SSLCertificateFile /var/www/html/certs/cert.pem
    SSLCertificateKeyFile /var/www/html/certs/key.pem
</VirtualHost>
